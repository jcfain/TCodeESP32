class MotionGenerator extends HTMLElement{setMotionGeneratorNameDebounce=0;selectedMotionProfileIndex=0;validateGeneratorSettingsDebounce=0;connectedCallback(){this.innerHTML='\n      <div>\n          <div>\n              <div class="tHeader">\n                  <h3>Motion generator</h3>\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"></div>\n              <div class="tCell">\n                  \x3c!-- <input id="motionEnabled" type="checkbox" oninput="setMotionEnabledClicked()"> --\x3e\n                  <button id="motionEnabledToggle" class="button-toggle-start" onclick="setMotionEnabledClicked()">Start</button>\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span>Profile</span></div>\n              <div class="tCell">\n                  <div id="motionProfiles"></div>\n                  \x3c!-- <select id="motionProfiles" onchange="setMotionGeneratorProfile()"></select> --\x3e\n                  \x3c!-- <button id="addMotionProfile" onclick="addMotionProfile()">+</button>\n                  <button id="deleteMotionProfile" onclick="deleteMotionProfile()">-</button> --\x3e\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span></span></div>\n              <div class="tCell">\n                  <button id="setMotionProfileDefault" onclick="setMotionProfileDefault()">Set current profile as default</button>\n                  \x3c!-- <button id="addMotionProfile" onclick="addMotionProfile()">+</button>\n                  <button id="deleteMotionProfile" onclick="deleteMotionProfile()">-</button> --\x3e\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span>Profile name</span></div>\n              <div class="tCell">\n                  <input id="motionProfileName" type="text"  maxlength="31" oninput="setMotionGeneratorName()">\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span tite="This is the time in between updates that gives the system time to process other tasks. (DO NOT SET TOO LOW ON ESP32!)\n                  It may be best to just leave at default.">Update rate (ms)</span></div>\n              <div class="tCell">\n                  <input id="motionUpdateGlobal" type="number" min="1" max="2147483647" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span tite="THis is the time it takes to make a revolution.\nLower is faster movement.">Period (ms)</span></div>\n              <div class="tCell">\n                  <input id="motionPeriodGlobal" type="number" min="0" max="2147483647" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span>Period random</span></div>\n              <div class="tCell">\n                  <input id="motionPeriodGlobalRandom" type="checkbox" oninput="setMotionPeriodGlobalRandomClicked()">\n              </div>\n          </div>\n          <div class="tRow" id="motionPeriodGlobalRandomMinRow">\n              <div class="tCell"><span>Min (ms)</span></div>\n              <div class="tCell">\n                  <input id="motionPeriodGlobalRandomMin" type="number" min="0" max="2147483647" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow" id="motionPeriodGlobalRandomMaxRow">\n              <div class="tCell"><span>Max (ms)</span></div>\n              <div class="tCell">\n                  <input id="motionPeriodGlobalRandomMax" type="number" min="0" max="2147483647" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span>Amplitude (%)</span></div>\n              <div class="tCell">\n                  <input id="motionAmplitudeGlobal" type="number" min="0" max="100" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span>Amplitude random</span></div>\n              <div class="tCell">\n                  <input id="motionAmplitudeGlobalRandom" type="checkbox" oninput="setMotionAmplitudeGlobalRandomClicked()">\n              </div>\n          </div>\n          <div class="tRow" id="motionAmplitudeGlobalRandomMinRow">\n              <div class="tCell"><span>Min (%)</span></div>\n              <div class="tCell">\n                  <input id="motionAmplitudeGlobalRandomMin" type="number" min="0" max="100" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow" id="motionAmplitudeGlobalRandomMaxRow">\n              <div class="tCell"><span>Max (%)</span></div>\n              <div class="tCell">\n                  <input id="motionAmplitudeGlobalRandomMax" type="number" min="0" max="100" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span>Offset (tcode)</span></div>\n              <div class="tCell">\n                  <input id="motionOffsetGlobal" type="number" min="0" max="9999" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow">\n              <div class="tCell"><span>Offset random</span></div>\n              <div class="tCell">\n                  <input id="motionOffsetGlobalRandom" type="checkbox" oninput="setMotionOffsetGlobalRandomRandomClicked()">\n              </div>\n          </div>\n          <div class="tRow" id="motionOffsetGlobalRandomMinRow">\n              <div class="tCell"><span>Min (tcode)</span></div>\n              <div class="tCell">\n                  <input id="motionOffsetGlobalRandomMin" type="number" min="0" max="9999" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow" id="motionOffsetGlobalRandomMaxRow">\n              <div class="tCell"><span>Max (tcode)</span></div>\n              <div class="tCell">\n                  <input id="motionOffsetGlobalRandomMax" type="number" min="0" max="9999" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          \x3c!-- <div>\n              <div class="tCell"><span title="Initial phase in degrees. The phase should ideally be between (offset-amplitude/2) and (offset+amplitude/2)">Phase</span></div>\n              <div class="tCell">\n                  <input id="motionPhaseGlobal" type="number" min="0" step="0.01" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div> --\x3e\n          <div class="tRow" id="motionRandomChangeMinRow">\n              <div class="tCell"><span title="Gate the random change period between all attributes in between two values.\n                  If this random value time outs and any attribute hasnt timed out yet,\n                  it will wait till the next timeout. All attributes get thier own random change value based on the min/max">Random change min (ms)</span></div>\n              <div class="tCell">\n                  <input id="motionRandomChangeMin" type="number" min="1" max="2147483647" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          <div class="tRow" id="motionRandomChangeMaxRow">\n              <div class="tCell"><span title="Gate the random change period between all attributes in between two values.\n                  If this random value time outs and any attribute hasnt timed out yet,\n                  it will wait till the next timeout. All attributes get thier own random change value based on the min/max">Random change max (ms)</span></div>\n              <div class="tCell">\n                  <input id="motionRandomChangeMax" type="number" min="1" max="2147483647" step="1" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div>\n          \x3c!-- <div>\n              <div class="tCell"><span>Reverse</span></div>\n              <div class="tCell">\n                  <input id="motionReversedGlobal" type="checkbox" oninput="setMotionGeneratorSettings()">\n              </div>\n          </div> --\x3e\n          <div class="tRow">\n              <div class="tCell"><span></span></div>\n              <div class="tCell">\n                  <button id="motionDefault" onclick="setMotionGeneratorSettingsDefault()">Default</button>\n              </div>\n          </div>\n      </div>\n          '}setup(){const e=document.getElementById("motionProfiles");removeAllChildren(e),userSettings.motionProfiles.forEach(((e,t)=>{addMotionProfileOption(t,e,t==userSettings.motionDefaultProfileIndex)}));const t=userSettings.motionDefaultProfileIndex;document.getElementById("motionProfiles").value=t,document.getElementById("motionProfileName").value=userSettings.motionProfiles[t].name,document.getElementById("motionUpdateGlobal").value=userSettings.motionProfiles[t].update,document.getElementById("motionPeriodGlobal").value=userSettings.motionProfiles[t].period,document.getElementById("motionAmplitudeGlobal").value=userSettings.motionProfiles[t].amp,document.getElementById("motionOffsetGlobal").value=userSettings.motionProfiles[t].offset,document.getElementById("motionPeriodGlobalRandom").checked=userSettings.motionProfiles[t].periodRan,document.getElementById("motionAmplitudeGlobalRandom").checked=userSettings.motionProfiles[t].ampRan,document.getElementById("motionOffsetGlobalRandom").checked=userSettings.motionProfiles[t].offsetRan,toggleMotionRandomSettings(),document.getElementById("motionPeriodGlobalRandomMin").value=userSettings.motionProfiles[t].periodMin,document.getElementById("motionPeriodGlobalRandomMax").value=userSettings.motionProfiles[t].periodMax,document.getElementById("motionAmplitudeGlobalRandomMin").value=userSettings.motionProfiles[t].ampMin,document.getElementById("motionAmplitudeGlobalRandomMax").value=userSettings.motionProfiles[t].ampMax,document.getElementById("motionOffsetGlobalRandomMin").value=userSettings.motionProfiles[t].offsetMin,document.getElementById("motionOffsetGlobalRandomMax").value=userSettings.motionProfiles[t].offsetMax,document.getElementById("motionRandomChangeMax").value=userSettings.motionProfiles[t].ranMax,document.getElementById("motionRandomChangeMin").value=userSettings.motionProfiles[t].ranMin,setIntMinAndMax("motionPeriodGlobalRandomMin","motionPeriodGlobalRandomMax"),setIntMinAndMax("motionAmplitudeGlobalRandomMin","motionAmplitudeGlobalRandomMax"),setIntMinAndMax("motionOffsetGlobalRandomMin","motionOffsetGlobalRandomMax"),setIntMinAndMax("motionRandomChangeMin","motionRandomChangeMax")}setEnabledStatus(){var e=document.getElementById("motionEnabledToggle");e.innerText=userSettings.motionEnabled?"Stop":"Start",userSettings.motionEnabled?(e.classList.add("button-toggle-stop"),e.classList.remove("button-toggle-start")):(e.classList.remove("button-toggle-stop"),e.classList.add("button-toggle-start"))}toggleMotionRandomSettings(){var e=getMotionProfileSelectedIndex();Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMinRow",userSettings.motionProfiles[e].offsetRan),Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMaxRow",userSettings.motionProfiles[e].offsetRan),Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMinRow",userSettings.motionProfiles[e].ampRan),Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMaxRow",userSettings.motionProfiles[e].ampRan),Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMinRow",userSettings.motionProfiles[e].periodRan),Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMaxRow",userSettings.motionProfiles[e].periodRan),toggleMotionRandomMinMaxSettingsSettings()}toggleMotionRandomMinMaxSettingsSettings(){var e=getMotionProfileSelectedIndex();Utils.toggleControlVisibilityByID("motionRandomChangeMinRow",userSettings.motionProfiles[e].offsetRan||userSettings.motionProfiles[e].ampRan||userSettings.motionProfiles[e].periodRan),Utils.toggleControlVisibilityByID("motionRandomChangeMaxRow",userSettings.motionProfiles[e].offsetRan||userSettings.motionProfiles[e].ampRan||userSettings.motionProfiles[e].periodRan)}setMotionEnabledClicked(){userSettings.motionEnabled=!userSettings.motionEnabled,sendTCode(userSettings.motionEnabled?"$motion-enable":"$motion-disable"),MotionGenerator.setEnabledStatus()}setMotionPeriodGlobalRandomClicked(){var e=getMotionProfileSelectedIndex(),t=document.getElementById("motionPeriodGlobalRandom").checked;t?sendTCode("$motion-period-random-on"):sendTCode("$motion-period-random-off"),userSettings.motionProfiles[e].motionPeriodGlobalRandom=t,Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMinRow",userSettings.motionProfiles[e].periodRan),Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMaxRow",userSettings.motionProfiles[e].periodRan),toggleMotionRandomMinMaxSettingsSettings(),updateUserSettings()}setMotionAmplitudeGlobalRandomClicked(){var e=getMotionProfileSelectedIndex(),t=document.getElementById("motionAmplitudeGlobalRandom").checked;t?sendTCode("$motion-amplitude-random-on"):sendTCode("$motion-amplitude-random-off"),userSettings.motionProfiles[e].motionAmplitudeGlobalRandom=t,Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMinRow",userSettings.motionProfiles[e].ampRan),Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMaxRow",userSettings.motionProfiles[e].ampRan),toggleMotionRandomMinMaxSettingsSettings(),updateUserSettings()}setMotionOffsetGlobalRandomRandomClicked(){var e=getMotionProfileSelectedIndex(),t=document.getElementById("motionOffsetGlobalRandom").checked;t?sendTCode("$motion-offset-random-on"):sendTCode("$motion-offset-random-off"),userSettings.motionProfiles[e].motionOffsetGlobalRandom=t,Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMinRow",userSettings.motionProfiles[e].offsetRan),Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMaxRow",userSettings.motionProfiles[e].offsetRan),toggleMotionRandomMinMaxSettingsSettings(),updateUserSettings()}setMotionProfileDefault(){userSettings.motionDefaultProfileIndex=getMotionProfileSelectedIndex(),updateUserSettings(1)}getMotionProfileSelectedIndex(){return selectedMotionProfileIndex}setSelectedMotionProfileIndex(e){selectedMotionProfileIndex=parseInt(e)}clearMotionProfileSelection(){var e=document.getElementsByName("motionProfileButton");e&&e.forEach((e=>e.classList.remove("button-pressed")))}selectMotionProfile(e,t){clearMotionProfileSelection(),setSelectedMotionProfileIndex(e);document.getElementById(`motionProfile${e}`).classList.add("button-pressed"),setMotionGeneratorSettingsProfile(e),t&&sendTCode(`$motion-set-profile:${e+1}`)}setMotionGeneratorSettings(){validateGeneratorSettingsDebounce&&clearTimeout(validateGeneratorSettingsDebounce),validateGeneratorSettingsDebounce=setTimeout((()=>{var e=getMotionProfileSelectedIndex();validateIntControl("motionUpdateGlobal",userSettings.motionProfiles[e],"update"),validateIntControl("motionPeriodGlobal",userSettings.motionProfiles[e],"period"),validateIntControl("motionAmplitudeGlobal",userSettings.motionProfiles[e],"amp"),validateIntControl("motionOffsetGlobal",userSettings.motionProfiles[e],"offset"),setIntMinAndMax("motionPeriodGlobalRandomMin","motionPeriodGlobalRandomMax"),validateIntControl("motionPeriodGlobalRandomMin",userSettings.motionProfiles[e],"periodMin"),validateIntControl("motionPeriodGlobalRandomMax",userSettings.motionProfiles[e],"periodMax"),setIntMinAndMax("motionAmplitudeGlobalRandomMin","motionAmplitudeGlobalRandomMax"),validateIntControl("motionAmplitudeGlobalRandomMin",userSettings.motionProfiles[e],"ampMin"),validateIntControl("motionAmplitudeGlobalRandomMax",userSettings.motionProfiles[e],"ampMax"),setIntMinAndMax("motionOffsetGlobalRandomMin","motionOffsetGlobalRandomMax"),validateIntControl("motionOffsetGlobalRandomMin",userSettings.motionProfiles[e],"offsetMin"),validateIntControl("motionOffsetGlobalRandomMax",userSettings.motionProfiles[e],"offsetMax"),setIntMinAndMax("motionRandomChangeMin","motionRandomChangeMax"),validateIntControl("motionRandomChangeMin",userSettings.motionProfiles[e],"ranMin"),validateIntControl("motionRandomChangeMax",userSettings.motionProfiles[e],"ranMax"),updateUserSettings(1)}),3e3)}setMotionGeneratorName(){setMotionGeneratorNameDebounce&&clearTimeout(setMotionGeneratorNameDebounce),setMotionGeneratorNameDebounce=setTimeout((()=>{var e=getMotionProfileSelectedIndex();validateStringControl("motionProfileName",userSettings.motionProfiles[e])&&(updateMotionProfileName(e),updateUserSettings(1))}),3e3)}addMotionProfileOption(e,t,o){const n=document.getElementById("motionProfiles");var i=document.createElement("button");i.id=`motionProfile${e}`,i.name="motionProfileButton",i.value=e,i.innerText=t.name,i.onclick=function(e,t){selectMotionProfile(e,!0)}.bind(this,e),n.appendChild(i),o&&selectMotionProfile(e)}updateMotionProfileName(e){const t=document.getElementsByName("motionProfileButton");for(var o=getMotionProfileSelectedIndex(),n=0;n<t.length;n++)if(t[n].value==e){o=n;break}t[o].innerText=userSettings.motionProfiles[e].name}setMotionGeneratorSettingsDefault(){var e=getMotionProfileSelectedIndex();confirm(`Are you sure you want to set the current profile '${userSettings.motionProfiles[e].name}' to the default settings?`)&&(setProfileMotionGeneratorSettingsDefault(e),updateUserSettings(1))}setProfileMotionGeneratorSettingsDefault(e){userSettings.motionProfiles[e].name="Profile "+(e+1),userSettings.motionProfiles[e].update=100,userSettings.motionProfiles[e].period=2e3,userSettings.motionProfiles[e].amp=60,userSettings.motionProfiles[e].offset=5e3,userSettings.motionProfiles[e].periodRan=!1,userSettings.motionProfiles[e].periodMin=500,userSettings.motionProfiles[e].periodMax=2e3,userSettings.motionProfiles[e].ampRan=!1,userSettings.motionProfiles[e].ampMin=20,userSettings.motionProfiles[e].ampMax=60,userSettings.motionProfiles[e].offsetRan=!1,userSettings.motionProfiles[e].offsetMin=3e3,userSettings.motionProfiles[e].offsetMax=7e3,userSettings.motionProfiles[e].ranMin=3e3,userSettings.motionProfiles[e].ranMax=3e4,userSettings.motionProfiles[e].phase=0,userSettings.motionProfiles[e].reverse=!1,setMotionGeneratorSettingsProfile(e)}setMotionGeneratorSettingsProfile(e){document.getElementById("motionProfileName").value=userSettings.motionProfiles[e].name,document.getElementById("motionUpdateGlobal").value=userSettings.motionProfiles[e].update,document.getElementById("motionPeriodGlobal").value=userSettings.motionProfiles[e].period,document.getElementById("motionAmplitudeGlobal").value=userSettings.motionProfiles[e].amp,document.getElementById("motionOffsetGlobal").value=userSettings.motionProfiles[e].offset,document.getElementById("motionPeriodGlobalRandom").checked=userSettings.motionProfiles[e].periodRan,document.getElementById("motionPeriodGlobalRandomMin").value=userSettings.motionProfiles[e].periodMin,document.getElementById("motionPeriodGlobalRandomMax").value=userSettings.motionProfiles[e].periodMax,document.getElementById("motionAmplitudeGlobalRandom").checked=userSettings.motionProfiles[e].ampRan,document.getElementById("motionAmplitudeGlobalRandomMin").value=userSettings.motionProfiles[e].ampMin,document.getElementById("motionAmplitudeGlobalRandomMax").value=userSettings.motionProfiles[e].ampMax,document.getElementById("motionOffsetGlobalRandom").checked=userSettings.motionProfiles[e].offsetRan,document.getElementById("motionOffsetGlobalRandomMin").value=userSettings.motionProfiles[e].offsetMin,document.getElementById("motionOffsetGlobalRandomMax").value=userSettings.motionProfiles[e].offsetMax,document.getElementById("motionRandomChangeMin").value=userSettings.motionProfiles[e].ranMin,document.getElementById("motionRandomChangeMax").value=userSettings.motionProfiles[e].ranMax,toggleMotionRandomSettings()}}customElements.define("motion-generator",MotionGenerator);