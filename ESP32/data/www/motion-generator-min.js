function toggleMotionRandomSettings(e){var t=getMotionProfileSelectedIndex();Utils.toggleControlVisibilityByID("motionOffsetRandomMinRow"+e,userSettings.motionProfiles[t].channels[e].offsetRan),Utils.toggleControlVisibilityByID("motionOffsetRandomMaxRow"+e,userSettings.motionProfiles[t].channels[e].offsetRan),Utils.toggleControlVisibilityByID("motionAmplitudeRandomMinRow"+e,userSettings.motionProfiles[t].channels[e].ampRan),Utils.toggleControlVisibilityByID("motionAmplitudeRandomMaxRow"+e,userSettings.motionProfiles[t].channels[e].ampRan),Utils.toggleControlVisibilityByID("motionPeriodRandomMinRow"+e,userSettings.motionProfiles[t].channels[e].periodRan),Utils.toggleControlVisibilityByID("motionPeriodRandomMaxRow"+e,userSettings.motionProfiles[t].channels[e].periodRan),Utils.toggleControlVisibilityByID("motionPhaseRandomMinRow"+e,userSettings.motionProfiles[t].channels[e].phaseRan),Utils.toggleControlVisibilityByID("motionPhaseRandomMaxRow"+e,userSettings.motionProfiles[t].channels[e].phaseRan),toggleMotionRandomMinMaxSettingsSettings(e)}function toggleMotionRandomMinMaxSettingsSettings(e){var t=getMotionProfileSelectedIndex();Utils.toggleControlVisibilityByID("motionRandomChangeMinRow"+e,userSettings.motionProfiles[t].channels[e].offsetRan||userSettings.motionProfiles[t].channels[e].ampRan||userSettings.motionProfiles[t].channels[e].periodRan||userSettings.motionProfiles[t].channels[e].phaseRan),Utils.toggleControlVisibilityByID("motionRandomChangeMaxRow"+e,userSettings.motionProfiles[t].channels[e].offsetRan||userSettings.motionProfiles[t].channels[e].ampRan||userSettings.motionProfiles[t].channels[e].periodRan||userSettings.motionProfiles[t].channels[e].phaseRan)}function setMotionEnabledClicked(){userSettings.motionEnabled=!userSettings.motionEnabled,sendTCode(userSettings.motionEnabled?"$motion-enable":"$motion-disable"),MotionGenerator.setEnabledStatus()}function setMotionPeriodRandomClicked(e){var t=getMotionProfileSelectedIndex(),n=document.getElementById("motionPeriodRandom"+e).checked;userSettings.motionProfiles[t].channels[e].motionPeriodRandom=n,Utils.toggleControlVisibilityByID("motionPeriodRandomMinRow"+e,userSettings.motionProfiles[t].channels[e].periodRan),Utils.toggleControlVisibilityByID("motionPeriodRandomMaxRow"+e,userSettings.motionProfiles[t].channels[e].periodRan),toggleMotionRandomMinMaxSettingsSettings(e),updateUserSettings()}function setMotionAmplitudeRandomClicked(e){var t=getMotionProfileSelectedIndex(),n=document.getElementById("motionAmplitudeRandom"+e).checked;userSettings.motionProfiles[t].channels[e].ampRan=n,Utils.toggleControlVisibilityByID("motionAmplitudeRandomMinRow"+e,n),Utils.toggleControlVisibilityByID("motionAmplitudeRandomMaxRow"+e,n),toggleMotionRandomMinMaxSettingsSettings(e),updateUserSettings()}function setMotionOffsetRandomClicked(e){var t=getMotionProfileSelectedIndex(),n=document.getElementById("motionOffsetRandom"+e).checked;userSettings.motionProfiles[t].channels[e].offsetRan=n,Utils.toggleControlVisibilityByID("motionOffsetRandomMinRow"+e,n),Utils.toggleControlVisibilityByID("motionOffsetRandomMaxRow"+e,n),toggleMotionRandomMinMaxSettingsSettings(e),updateUserSettings()}function setMotionPhaseRandomClicked(e){var t=getMotionProfileSelectedIndex(),n=document.getElementById("motionPhaseRandom"+e).checked;userSettings.motionProfiles[t].channels[e].phaseRan=n,Utils.toggleControlVisibilityByID("motionPhaseRandomMinRow"+e,n),Utils.toggleControlVisibilityByID("motionPhaseRandomMaxRow"+e,n),toggleMotionRandomMinMaxSettingsSettings(e),updateUserSettings()}function setMotionProfileDefault(){userSettings.motionDefaultProfileIndex=getMotionProfileSelectedIndex(),updateUserSettings(1)}MotionGenerator={channelTemplates:[],setup(){const e=document.getElementById("motionProfiles");removeAllChildren(e),channelTemplates=[];const t=userSettings.motionDefaultProfileIndex;e.value=t;var n=getChannelMap();userSettings.motionProfiles.forEach(((e,o)=>{addMotionProfileOption(o,e);var i=document.createElement("div");i.classList.add("formTable"),i.style="box-shadow: none; width: 100%;",i.id="channelContainer"+o,i.name="channelContainer";var a=document.createElement("div"),s=document.createElement("div");s.classList.add("tHeader");var l=document.createElement("h3");l.innerText="Edit profile",s.appendChild(l),a.appendChild(s);let r=Utils.createTextFormRow(0,"Profile name","motionProfileName"+o,e.name,31,function(e){setMotionGeneratorName(e)}.bind(this,o));a.appendChild(r.row),n.forEach(((e,n)=>{var i=e.channel,s=e.channelName,l=userSettings.motionProfiles[t].channels.findIndex((e=>e.name==i));const r=userSettings.motionProfiles[t].channels[l];var d=document.createElement("div");d.classList.add("tRow"),d.classList.add("motion-profile-edit-channel-header");var m=document.createElement("div");m.classList.add("tCell");var c=document.createElement("div");c.classList.add("tCell");var u=document.createElement("span");u.for="motionChannelCheckbox"+n,u.innerText=s+" ("+i+")";var f=document.createElement("input");f.id="motionChannelCheckbox"+n,f.type="checkbox",f.classList.add("motion-profile-edit-channel-header-checkbox"),f.value={name:i,profileIndex:o,channelIndex:n},f.checked=l>-1,f.onclick=function(){var e=this.value;const n=userSettings.motionProfiles[t].channels.findIndex((t=>t.name==e.name));n>-1&&(r=userSettings.motionProfiles[t].channels[n],userSettings.motionProfiles[t].channels.splice(n,1)),this.checked&&setProfileMotionGeneratorSettingsDefault(e.profileIndex,e.channelIndex),updateUserSettings()};var g=document.createElement("button");g.innerText="Edit",g.onclick=function(){},m.appendChild(u),m.appendChild(f),c.appendChild(g),d.appendChild(m),d.appendChild(c),a.appendChild(d);let h=Utils.createNumericFormRow(0,"Update rate (ms)","motionUpdate"+n,r?r.update:100,0,2147483647,function(e){setMotionGeneratorSettings(e)}.bind(this,n));h.title="This is the time in between updates that gives the system time to process other tasks. (DO NOT SET TOO LOW ON ESP32!)\n                It may be best to just leave at default.",a.appendChild(h.row),h=Utils.createNumericFormRow(0,"Period (ms)","motionPeriod"+n,r?r.period:2e3,0,2147483647,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),h.title="This is the time it takes to make one stroke.\n                Lower is faster movement.",a.appendChild(h.row),h=Utils.createCheckboxFormRow(0,"Period random","motionPeriodRandom"+n,!!r&&r.periodRan,function(e){setMotionPeriodRandomClicked(e)}.bind(this,n)),h.title="This is the time it takes to make one stroke.\n                Lower is faster movement.",a.appendChild(h.row),h=Utils.createNumericFormRow("motionPeriodRandomMinRow"+n,"Min (ms)","motionPeriodRandomMin"+n,r?r.periodMin:500,0,2147483647,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row);let M=h.input;h=Utils.createNumericFormRow("motionPeriodRandomMaxRow"+n,"Max (ms)","motionPeriodRandomMax"+n,r?r.periodMax:2e3,0,2147483647,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),setElementsIntMinAndMax(M,h.input),h=Utils.createNumericFormRow(0,"Amplitude (%)","motionAmplitude"+n,r?r.amp:60,0,100,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),h=Utils.createCheckboxFormRow(0,"Amplitude random","motionAmplitudeRandom"+n,!!r&&r.ampRan,function(e){setMotionAmplitudeRandomClicked(e)}.bind(this,n)),a.appendChild(h.row),h=Utils.createNumericFormRow("motionAmplitudeRandomMinRow"+n,"Min (%)","motionAmplitudeRandomMin"+n,r?r.ampMin:20,0,100,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),M=h.input,h=Utils.createNumericFormRow("motionAmplitudeRandomMaxRow"+n,"Max (%)","motionAmplitudeRandomMax"+n,r?r.ampMax:60,0,100,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),setElementsIntMinAndMax(M,h.input),h=Utils.createNumericFormRow(0,"Offset (tcode)","motionOffset"+n,r?r.offset:5e3,0,9999,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),h=Utils.createCheckboxFormRow(0,"Offset random","motionOffsetRandom"+n,!!r&&r.offsetRan,function(e){setMotionOffsetRandomClicked(e)}.bind(this,n)),a.appendChild(h.row),h=Utils.createNumericFormRow("motionOffsetRandomMinRow"+n,"Min (tcode)","motionOffsetRandomMin"+n,r?r.offsetMin:3e3,0,9999,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),M=h.input,h=Utils.createNumericFormRow("motionOffsetRandomMaxRow"+n,"Max (tcode)","motionOffsetRandomMax"+n,r?r.offsetMax:7e3,0,9999,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),setElementsIntMinAndMax(M,h.input),h=Utils.createNumericFormRow(0,"Phase (degrees)","motionPhase"+n,r?r.phase:0,0,180,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),h=Utils.createCheckboxFormRow(0,"Phase random","motionPhaseRandom"+n,!!r&&r.phaseRan,function(e){setMotionPhaseRandomClicked(e)}.bind(this,n)),a.appendChild(h.row),h=Utils.createNumericFormRow("motionPhaseRandomMinRow"+n,"Min (degree)","motionPhaseRandomMin"+n,r?r.phaseMin:0,0,180,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),M=h.input,h=Utils.createNumericFormRow("motionPhaseRandomMaxRow"+n,"Max (degree)","motionPhaseRandomMax"+n,r?r.phaseMax:180,0,180,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),setElementsIntMinAndMax(M,h.input),h=Utils.createNumericFormRow("motionRandomChangeMinRow"+n,"Random change max (ms)","motionRandomChangeMin"+n,r?r.ranMin:3e3,0,2147483647,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),M=h.input,h=Utils.createNumericFormRow("motionRandomChangeMaxRow"+n,"Random change max (ms)","motionRandomChangeMax"+n,r?r.ranMax:3e4,0,2147483647,function(e){setMotionGeneratorSettings(e)}.bind(this,n)),a.appendChild(h.row),setElementsIntMinAndMax(M,h.input)})),i.appendChild(a),channelTemplates.push(i)})),selectMotionProfile(userSettings.motionDefaultProfileIndex)},setEnabledStatus(){var e=document.getElementById("motionEnabledToggle");e.innerText=userSettings.motionEnabled?"Stop":"Start",userSettings.motionEnabled?(e.classList.add("button-toggle-stop"),e.classList.remove("button-toggle-start")):(e.classList.remove("button-toggle-stop"),e.classList.add("button-toggle-start"))}};var validateGeneratorSettingsDebounce,setMotionGeneratorNameDebounce,selectedMotionProfileIndex=0;function getMotionProfileSelectedIndex(){return selectedMotionProfileIndex}function setSelectedMotionProfileIndex(e){selectedMotionProfileIndex=parseInt(e)}function clearMotionProfileSelection(){var e=document.getElementsByName("motionProfileButton");e&&e.forEach((e=>e.classList.remove("button-pressed")))}function selectMotionProfile(e,t){clearMotionProfileSelection(),setSelectedMotionProfileIndex(e);document.getElementById(`motionProfile${e}`).classList.add("button-pressed"),t&&sendTCode(`$motion-set-profile:${e+1}`)}function editMotionProfile(e){const t=document.getElementById("motionChannelsModal");removeAllChildren(t),t.appendChild(channelTemplates[e]),setMotionGeneratorSettingsProfile(e),t.setAttribute("visible",!0)}function setMotionGeneratorSettings(e){validateGeneratorSettingsDebounce&&clearTimeout(validateGeneratorSettingsDebounce),validateGeneratorSettingsDebounce=setTimeout(function(e){var t=getMotionProfileSelectedchannelIndex(),n=userSettings.motionProfiles[t].channels[e];validateIntControl("motionUpdate"+e,n,"update"),validateIntControl("motionPeriod"+e,n,"period"),validateIntControl("motionAmplitude"+e,n,"amp"),validateIntControl("motionOffset"+e,n,"offset"),setIntMinAndMax("motionPeriodRandomMin"+e,"motionPeriodRandomMax"+e),validateIntControl("motionPeriodRandomMin"+e,n,"periodMin"),validateIntControl("motionPeriodRandomMax"+e,n,"periodMax"),setIntMinAndMax("motionAmplitudeRandomMin"+e,"motionAmplitudeRandomMax"+e),validateIntControl("motionAmplitudeRandomMin"+e,n,"ampMin"),validateIntControl("motionAmplitudeRandomMax"+e,n,"ampMax"),setIntMinAndMax("motionOffsetRandomMin"+e,"motionOffsetRandomMax"+e),validateIntControl("motionOffsetRandomMin"+e,n,"offsetMin"),validateIntControl("motionOffsetRandomMax"+e,n,"offsetMax"),setIntMinAndMax("motionRandomChangeMin"+e,"motionRandomChangeMax"+e),validateIntControl("motionRandomChangeMin"+e,n,"ranMin"),validateIntControl("motionRandomChangeMax"+e,n,"ranMax"),updateUserSettings(1)}.bind(this,e),3e3)}function setMotionGeneratorName(e){setMotionGeneratorNameDebounce&&clearTimeout(setMotionGeneratorNameDebounce),setMotionGeneratorNameDebounce=setTimeout(function(e){var t=getMotionProfileSelectedIndex();validateStringControl("motionProfileName"+e,userSettings.motionProfiles[t].motionProfileName)&&(updateMotionProfileName(t),updateUserSettings(1))}.bind(this,e),3e3)}function addMotionProfileOption(e,t){document.getElementsByName("channelContainer").forEach((e=>{Utils.toggleElementShown(e,!1)}));const n=document.getElementById("motionProfiles");var o=document.createElement("button");o.id=`motionProfile${e}`,o.name="motionProfileButton",o.value=e,o.innerText=t.name,o.onclick=function(e){selectMotionProfile(e,!0)}.bind(this,e);var i=document.createElement("button");i.id=`motionProfileEdit${e}`,i.name="motionProfileEditButton",i.value=e,i.innerText="Edit",i.onclick=function(e){editMotionProfile(e)}.bind(this,e),n.appendChild(o),n.appendChild(i)}function updateMotionProfileName(e){const t=document.getElementsByName("motionProfileButton");for(var n=getMotionProfileSelectedIndex(),o=0;o<t.length;o++)if(t[o].value==e){n=o;break}t[n].innerText=userSettings.motionProfiles[e].name}function setMotionGeneratorSettingsDefault(e){var t=getMotionProfileSelectedIndex();confirm(`Are you sure you want to set the current profile '${userSettings.motionProfiles[t].name}' to the default settings?`)&&(setProfileMotionGeneratorSettingsDefault(t,e),updateUserSettings(1))}function setProfileMotionGeneratorSettingsDefault(e,t){userSettings.motionProfiles[e].name="Profile "+(e+1),userSettings.motionProfiles[e].channels[t].update=100,userSettings.motionProfiles[e].channels[t].period=2e3,userSettings.motionProfiles[e].channels[t].amp=60,userSettings.motionProfiles[e].channels[t].offset=5e3,userSettings.motionProfiles[e].channels[t].periodRan=!1,userSettings.motionProfiles[e].channels[t].periodMin=500,userSettings.motionProfiles[e].channels[t].periodMax=2e3,userSettings.motionProfiles[e].channels[t].ampRan=!1,userSettings.motionProfiles[e].channels[t].ampMin=20,userSettings.motionProfiles[e].channels[t].ampMax=60,userSettings.motionProfiles[e].channels[t].offsetRan=!1,userSettings.motionProfiles[e].channels[t].offsetMin=3e3,userSettings.motionProfiles[e].channels[t].offsetMax=7e3,userSettings.motionProfiles[e].channels[t].ranMin=3e3,userSettings.motionProfiles[e].channels[t].ranMax=3e4,userSettings.motionProfiles[e].channels[t].phase=0,userSettings.motionProfiles[e].channels[t].phaseRan=!1,userSettings.motionProfiles[e].channels[t].phaseMin=0,userSettings.motionProfiles[e].channels[t].phaseMax=180,userSettings.motionProfiles[e].channels[t].reverse=!1,setMotionGeneratorSettingsProfile(e)}function setMotionGeneratorSettingsProfile(e){document.getElementById("motionProfileName"+e).value=userSettings.motionProfiles[e].name;userSettings.motionProfiles[e].channels.forEach(((e,t)=>{document.getElementById("motionUpdate"+t).value=e.update,document.getElementById("motionPeriod"+t).value=e.period,document.getElementById("motionAmplitude"+t).value=e.amp,document.getElementById("motionOffset"+t).value=e.offset,document.getElementById("motionPhase"+t).value=e.phase,document.getElementById("motionPhaseRandom"+t).checked=e.phaseRan,document.getElementById("motionPhaseRandomMin"+t).value=e.phaseMin,document.getElementById("motionPhaseRandomMax"+t).value=e.phaseMax,document.getElementById("motionPeriodRandom"+t).checked=e.periodRan,document.getElementById("motionPeriodRandomMin"+t).value=e.periodMin,document.getElementById("motionPeriodRandomMax"+t).value=e.periodMax,document.getElementById("motionAmplitudeRandom"+t).checked=e.ampRan,document.getElementById("motionAmplitudeRandomMin"+t).value=e.ampMin,document.getElementById("motionAmplitudeRandomMax"+t).value=e.ampMax,document.getElementById("motionOffsetRandom"+t).checked=e.offsetRan,document.getElementById("motionOffsetRandomMin"+t).value=e.offsetMin,document.getElementById("motionOffsetRandomMax"+t).value=e.offsetMax,document.getElementById("motionRandomChangeMin"+t).value=e.ranMin,document.getElementById("motionRandomChangeMax"+t).value=e.ranMax,toggleMotionRandomSettings(t)}))}