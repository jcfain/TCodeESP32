function toggleMotionRandomSettings(){var e=getMotionProfileSelectedIndex();Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMinRow",userSettings.motionProfiles[e].offsetRan),Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMaxRow",userSettings.motionProfiles[e].offsetRan),Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMinRow",userSettings.motionProfiles[e].ampRan),Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMaxRow",userSettings.motionProfiles[e].ampRan),Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMinRow",userSettings.motionProfiles[e].periodRan),Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMaxRow",userSettings.motionProfiles[e].periodRan),toggleMotionRandomMinMaxSettingsSettings()}function toggleMotionRandomMinMaxSettingsSettings(){var e=getMotionProfileSelectedIndex();Utils.toggleControlVisibilityByID("motionRandomChangeMinRow",userSettings.motionProfiles[e].offsetRan||userSettings.motionProfiles[e].ampRan||userSettings.motionProfiles[e].periodRan),Utils.toggleControlVisibilityByID("motionRandomChangeMaxRow",userSettings.motionProfiles[e].offsetRan||userSettings.motionProfiles[e].ampRan||userSettings.motionProfiles[e].periodRan)}function setMotionEnabledClicked(){userSettings.motionEnabled=!userSettings.motionEnabled,sendTCode(userSettings.motionEnabled?"$motion-enable":"$motion-disable"),MotionGenerator.setEnabledStatus()}function setMotionPeriodGlobalRandomClicked(){var e=getMotionProfileSelectedIndex(),t=document.getElementById("motionPeriodGlobalRandom").checked;t?sendTCode("$motion-period-random-on"):sendTCode("$motion-period-random-off"),userSettings.motionProfiles[e].motionPeriodGlobalRandom=t,Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMinRow",userSettings.motionProfiles[e].periodRan),Utils.toggleControlVisibilityByID("motionPeriodGlobalRandomMaxRow",userSettings.motionProfiles[e].periodRan),toggleMotionRandomMinMaxSettingsSettings(),updateUserSettings()}function setMotionAmplitudeGlobalRandomClicked(){var e=getMotionProfileSelectedIndex(),t=document.getElementById("motionAmplitudeGlobalRandom").checked;t?sendTCode("$motion-amplitude-random-on"):sendTCode("$motion-amplitude-random-off"),userSettings.motionProfiles[e].motionAmplitudeGlobalRandom=t,Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMinRow",userSettings.motionProfiles[e].ampRan),Utils.toggleControlVisibilityByID("motionAmplitudeGlobalRandomMaxRow",userSettings.motionProfiles[e].ampRan),toggleMotionRandomMinMaxSettingsSettings(),updateUserSettings()}function setMotionOffsetGlobalRandomRandomClicked(){var e=getMotionProfileSelectedIndex(),t=document.getElementById("motionOffsetGlobalRandom").checked;t?sendTCode("$motion-offset-random-on"):sendTCode("$motion-offset-random-off"),userSettings.motionProfiles[e].motionOffsetGlobalRandom=t,Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMinRow",userSettings.motionProfiles[e].offsetRan),Utils.toggleControlVisibilityByID("motionOffsetGlobalRandomMaxRow",userSettings.motionProfiles[e].offsetRan),toggleMotionRandomMinMaxSettingsSettings(),updateUserSettings()}function setMotionProfileDefault(){userSettings.motionDefaultProfileIndex=getMotionProfileSelectedIndex(),updateUserSettings(1)}MotionGenerator={setup(){const e=document.getElementById("motionProfiles");removeAllChildren(e),userSettings.motionProfiles.forEach(((e,t)=>{addMotionProfileOption(t,e,t==userSettings.motionDefaultProfileIndex)}));const t=userSettings.motionDefaultProfileIndex;document.getElementById("motionProfiles").value=t,document.getElementById("motionProfileName").value=userSettings.motionProfiles[t].name,document.getElementById("motionUpdateGlobal").value=userSettings.motionProfiles[t].update,document.getElementById("motionPeriodGlobal").value=userSettings.motionProfiles[t].period,document.getElementById("motionAmplitudeGlobal").value=userSettings.motionProfiles[t].amp,document.getElementById("motionOffsetGlobal").value=userSettings.motionProfiles[t].offset,document.getElementById("motionPeriodGlobalRandom").checked=userSettings.motionProfiles[t].periodRan,document.getElementById("motionAmplitudeGlobalRandom").checked=userSettings.motionProfiles[t].ampRan,document.getElementById("motionOffsetGlobalRandom").checked=userSettings.motionProfiles[t].offsetRan,toggleMotionRandomSettings(),document.getElementById("motionPeriodGlobalRandomMin").value=userSettings.motionProfiles[t].periodMin,document.getElementById("motionPeriodGlobalRandomMax").value=userSettings.motionProfiles[t].periodMax,document.getElementById("motionAmplitudeGlobalRandomMin").value=userSettings.motionProfiles[t].ampMin,document.getElementById("motionAmplitudeGlobalRandomMax").value=userSettings.motionProfiles[t].ampMax,document.getElementById("motionOffsetGlobalRandomMin").value=userSettings.motionProfiles[t].offsetMin,document.getElementById("motionOffsetGlobalRandomMax").value=userSettings.motionProfiles[t].offsetMax,document.getElementById("motionRandomChangeMax").value=userSettings.motionProfiles[t].ranMax,document.getElementById("motionRandomChangeMin").value=userSettings.motionProfiles[t].ranMin,setIntMinAndMax("motionPeriodGlobalRandomMin","motionPeriodGlobalRandomMax"),setIntMinAndMax("motionAmplitudeGlobalRandomMin","motionAmplitudeGlobalRandomMax"),setIntMinAndMax("motionOffsetGlobalRandomMin","motionOffsetGlobalRandomMax"),setIntMinAndMax("motionRandomChangeMin","motionRandomChangeMax")},setEnabledStatus(){var e=document.getElementById("motionEnabledToggle");e.innerText=userSettings.motionEnabled?"Stop":"Start",userSettings.motionEnabled?(e.classList.add("button-toggle-stop"),e.classList.remove("button-toggle-start")):(e.classList.remove("button-toggle-stop"),e.classList.add("button-toggle-start"))},setupChannels(){var e=document.getElementById("motionChannels");deleteAllChildren(e);var t=getChannelMap(),o=document.createElement("div");o.innerText="Generate motion on channels:",e.appendChild(o);var n=document.createElement("div");n.classList.add("tRow");var i=document.createElement("div");i.classList.add("tCell"),i.innerText="Enabled",i.style="border-right: solid 1px; padding-right: 6px;";var l=document.createElement("div");l.classList.add("tCell"),l.style="justify-content: space-between;";var s=document.createElement("span");s.innerText="Phase";var a="Initial phase in degrees. (0-180) The phase should ideally be between (offset-amplitude/2) and (offset+amplitude/2)";s.title=a;var m=document.createElement("span");m.innerText="Reverse",l.appendChild(s),l.appendChild(m),n.appendChild(i),n.appendChild(l),e.appendChild(n);for(var r=0;r<t.length;r++){var d=t[r];if(userSettings.sr6Mode||!d.sr6Only){var u=document.createElement("div");u.classList.add("tRow");var f=document.createElement("div");f.classList.add("tCell");var g=document.createElement("div");g.classList.add("tCell");var c=d.channel,M=d.channelName,S=userSettings.motionChannels.findIndex((e=>e.name==c)),p=document.createElement("span");p.for="motionChannelCheckbox"+c,p.innerText=M+" ("+c+")";var P=document.createElement("input");P.id="motionChannelCheckbox"+c,P.type="checkbox",P.value=c,P.checked=S>-1,P.onclick=function(){var e=this.value,t=document.getElementById("motionChannelPhaseInput"+e),o=document.getElementById("motionChannelReverseInput"+e);t.readOnly=!this.checked,this.checked||(t.value=0,o.checked=!1);const n=userSettings.motionChannels.findIndex((t=>t.name==e));var i={name:e,phase:0};n>-1&&(i=userSettings.motionChannels[n],userSettings.motionChannels.splice(n,1)),this.checked&&userSettings.motionChannels.push(i),updateUserSettings()};var b=document.createElement("input");b.id="motionChannelPhaseInput"+c,b.type="number",b.min=0,b.step=.01,b.max=180,b.readOnly=-1==S,b.value=-1==S?0:Utils.round2(userSettings.motionChannels[S].phase),b.name=c,b.title=a,b.oninput=function(){-1==userSettings.motionChannels.findIndex((e=>e.name==this.name))?this.checked=!1:Utils.debounce("phaseInput"+this.name,function(){var e=this.name;const t=userSettings.motionChannels.findIndex((t=>t.name==e));t>-1&&(userSettings.motionChannels[t].phase=parseFloat(this.value),updateUserSettings(500))}.bind(this),3e3)};var R=document.createElement("input");R.id="motionChannelReverseInput"+c,R.type="checkbox",R.readOnly=-1==S,R.checked=-1!=S&&userSettings.motionChannels[S].reverse,R.name=c,R.onclick=function(){-1==userSettings.motionChannels.findIndex((e=>e.name==this.name))?this.checked=!1:Utils.debounce("reverseInput"+this.name,function(){var e=this.name;const t=userSettings.motionChannels.findIndex((t=>t.name==e));t>-1?(userSettings.motionChannels[t].reverse=this.value,updateUserSettings(500)):this.checked=!1}.bind(this),3e3)},f.appendChild(p),f.appendChild(P),g.appendChild(b),g.appendChild(R),u.appendChild(f),u.appendChild(g),e.appendChild(u)}}}};var validateGeneratorSettingsDebounce,setMotionGeneratorNameDebounce,selectedMotionProfileIndex=0;function getMotionProfileSelectedIndex(){return selectedMotionProfileIndex}function setSelectedMotionProfileIndex(e){selectedMotionProfileIndex=parseInt(e)}function clearMotionProfileSelection(){var e=document.getElementsByName("motionProfileButton");e&&e.forEach((e=>e.classList.remove("button-pressed")))}function selectMotionProfile(e,t){clearMotionProfileSelection(),setSelectedMotionProfileIndex(e);document.getElementById(`motionProfile${e}`).classList.add("button-pressed"),setMotionGeneratorSettingsProfile(e),t&&sendTCode(`$motion-set-profile:${e+1}`)}function setMotionGeneratorSettings(){validateGeneratorSettingsDebounce&&clearTimeout(validateGeneratorSettingsDebounce),validateGeneratorSettingsDebounce=setTimeout((()=>{var e=getMotionProfileSelectedIndex();validateIntControl("motionUpdateGlobal",userSettings.motionProfiles[e],"update"),validateIntControl("motionPeriodGlobal",userSettings.motionProfiles[e],"period"),validateIntControl("motionAmplitudeGlobal",userSettings.motionProfiles[e],"amp"),validateIntControl("motionOffsetGlobal",userSettings.motionProfiles[e],"offset"),setIntMinAndMax("motionPeriodGlobalRandomMin","motionPeriodGlobalRandomMax"),validateIntControl("motionPeriodGlobalRandomMin",userSettings.motionProfiles[e],"periodMin"),validateIntControl("motionPeriodGlobalRandomMax",userSettings.motionProfiles[e],"periodMax"),setIntMinAndMax("motionAmplitudeGlobalRandomMin","motionAmplitudeGlobalRandomMax"),validateIntControl("motionAmplitudeGlobalRandomMin",userSettings.motionProfiles[e],"ampMin"),validateIntControl("motionAmplitudeGlobalRandomMax",userSettings.motionProfiles[e],"ampMax"),setIntMinAndMax("motionOffsetGlobalRandomMin","motionOffsetGlobalRandomMax"),validateIntControl("motionOffsetGlobalRandomMin",userSettings.motionProfiles[e],"offsetMin"),validateIntControl("motionOffsetGlobalRandomMax",userSettings.motionProfiles[e],"offsetMax"),setIntMinAndMax("motionRandomChangeMin","motionRandomChangeMax"),validateIntControl("motionRandomChangeMin",userSettings.motionProfiles[e],"ranMin"),validateIntControl("motionRandomChangeMax",userSettings.motionProfiles[e],"ranMax"),updateUserSettings(1)}),3e3)}function setMotionGeneratorName(){setMotionGeneratorNameDebounce&&clearTimeout(setMotionGeneratorNameDebounce),setMotionGeneratorNameDebounce=setTimeout((()=>{var e=getMotionProfileSelectedIndex();validateStringControl("motionProfileName",userSettings.motionProfiles[e])&&(updateMotionProfileName(e),updateUserSettings(1))}),3e3)}function addMotionProfileOption(e,t,o){const n=document.getElementById("motionProfiles");var i=document.createElement("button");i.id=`motionProfile${e}`,i.name="motionProfileButton",i.value=e,i.innerText=t.name,i.onclick=function(e,t){selectMotionProfile(e,!0)}.bind(this,e),n.appendChild(i),o&&selectMotionProfile(e)}function updateMotionProfileName(e){const t=document.getElementsByName("motionProfileButton");for(var o=getMotionProfileSelectedIndex(),n=0;n<t.length;n++)if(t[n].value==e){o=n;break}t[o].innerText=userSettings.motionProfiles[e].name}function setMotionGeneratorSettingsDefault(){var e=getMotionProfileSelectedIndex();confirm(`Are you sure you want to set the current profile '${userSettings.motionProfiles[e].name}' to the default settings?`)&&(setProfileMotionGeneratorSettingsDefault(e),updateUserSettings(1))}function setProfileMotionGeneratorSettingsDefault(e){userSettings.motionProfiles[e].name="Profile "+(e+1),userSettings.motionProfiles[e].update=100,userSettings.motionProfiles[e].period=2e3,userSettings.motionProfiles[e].amp=60,userSettings.motionProfiles[e].offset=5e3,userSettings.motionProfiles[e].periodRan=!1,userSettings.motionProfiles[e].periodMin=500,userSettings.motionProfiles[e].periodMax=2e3,userSettings.motionProfiles[e].ampRan=!1,userSettings.motionProfiles[e].ampMin=20,userSettings.motionProfiles[e].ampMax=60,userSettings.motionProfiles[e].offsetRan=!1,userSettings.motionProfiles[e].offsetMin=3e3,userSettings.motionProfiles[e].offsetMax=7e3,userSettings.motionProfiles[e].ranMin=3e3,userSettings.motionProfiles[e].ranMax=3e4,userSettings.motionProfiles[e].phase=0,userSettings.motionProfiles[e].reverse=!1,setMotionGeneratorSettingsProfile(e)}function setMotionGeneratorSettingsProfile(e){document.getElementById("motionProfileName").value=userSettings.motionProfiles[e].name,document.getElementById("motionUpdateGlobal").value=userSettings.motionProfiles[e].update,document.getElementById("motionPeriodGlobal").value=userSettings.motionProfiles[e].period,document.getElementById("motionAmplitudeGlobal").value=userSettings.motionProfiles[e].amp,document.getElementById("motionOffsetGlobal").value=userSettings.motionProfiles[e].offset,document.getElementById("motionPeriodGlobalRandom").checked=userSettings.motionProfiles[e].periodRan,document.getElementById("motionPeriodGlobalRandomMin").value=userSettings.motionProfiles[e].periodMin,document.getElementById("motionPeriodGlobalRandomMax").value=userSettings.motionProfiles[e].periodMax,document.getElementById("motionAmplitudeGlobalRandom").checked=userSettings.motionProfiles[e].ampRan,document.getElementById("motionAmplitudeGlobalRandomMin").value=userSettings.motionProfiles[e].ampMin,document.getElementById("motionAmplitudeGlobalRandomMax").value=userSettings.motionProfiles[e].ampMax,document.getElementById("motionOffsetGlobalRandom").checked=userSettings.motionProfiles[e].offsetRan,document.getElementById("motionOffsetGlobalRandomMin").value=userSettings.motionProfiles[e].offsetMin,document.getElementById("motionOffsetGlobalRandomMax").value=userSettings.motionProfiles[e].offsetMax,document.getElementById("motionRandomChangeMin").value=userSettings.motionProfiles[e].ranMin,document.getElementById("motionRandomChangeMax").value=userSettings.motionProfiles[e].ranMax,toggleMotionRandomSettings()}