DeviceRangeSlider={channels:[],minRange:250,sliderColor:"cornflowerblue",rangeColor:"grey",setup(){this.channels=getChannelMap();var e=document.getElementById("deviceRangesTable");deleteAllChildren(e),(_=document.createElement("div")).classList.add("range_container");var n=document.createElement("div");n.classList.add("form_control");var t=document.createElement("div");t.classList.add("form_control_container_header");var a=document.createElement("label");a.setAttribute("for","allEnabledCheckbox"),a.innerText="Toggle all",a.classList.add("range_container_header");var l=document.createElement("input");l.type="checkbox",l.id="allEnabledCheckbox",l.onclick=function(e){let n=document.getElementsByName("ChannelRangeEnabled");for(var t=0;t<n.length;t++)n[t].checked=e.checked,this.toggleChannelEnabled(this.channels[t].name,e.checked);this.updateSettings(0)}.bind(this,l);var i=document.createElement("div");i.setAttribute("title","This will temporarily toggle ALL ranges. This is always true on boot."),i.classList.add("form_control_container");var d=document.createElement("label");d.setAttribute("for","channelRangesEnabled"),d.innerText="Enabled";var r=document.createElement("input");r.id="channelRangesEnabled",r.type="checkbox",r.onclick=function(e){sendTCode(e.checked?"#channel-ranges-enable":"#channel-ranges-disable")}.bind(this,r),r.checked=systemInfo.channelRangesEnabled,t.appendChild(l),t.appendChild(a),n.appendChild(t),i.appendChild(d),i.appendChild(r),n.appendChild(i),_.appendChild(n),e.appendChild(_);for(var s=0;s<this.channels.length;s++){var o=this.channels[s];if(isSR6()||!o.sr6Only){var c=o.name,h=o.friendlyName;if(!o)return;var m,u=getTCodeMax();u=o.userMax,m=o.userMin;var g=document.createElement("div");g.classList.add("range_container_header");var p=document.createElement("span"),v=document.createElement("input");v.id=c+"ChannelRangeEnabled",v.setAttribute("name","ChannelRangeEnabled"),v.type="checkbox",v.checked=o.rangeLimitEnabled,v.onclick=function(e,n){e.rangeLimitEnabled=n.checked,this.toggleChannelEnabled(e.name,n.checked),this.updateAllToggleChk(),this.updateSettings()}.bind(this,o,v);var C=document.createElement("label");C.innerText=h,C.setAttribute("for",v.id),p.appendChild(v),p.appendChild(C),g.appendChild(p);var b=document.createElement("div");b.classList.add("form_control_container_header"),b.appendChild(g);var f=document.createElement("div");f.classList.add("sliders_control");var E=document.createElement("input");E.id="minSlider"+c,E.classList.add("fromSlider"),E.type="range",E.min=0,E.max=getTCodeMax()-1,E.value=m,f.appendChild(E);var T=document.createElement("input");T.id="maxSlider"+c,T.type="range",T.min=1,T.max=getTCodeMax(),T.value=u,f.appendChild(T);var x=document.createElement("div");x.classList.add("form_control");var M=document.createElement("div");M.classList.add("form_control_container");var k=document.createElement("label");k.classList.add("form_control_container_label"),k.innerText="Min",k.setAttribute("for","minInput"+c),M.appendChild(k);var y=document.createElement("input");y.id="minInput"+c,y.type="number",y.min=0,y.max=getTCodeMax()-1,y.value=m,M.appendChild(y);var S=document.createElement("div");S.classList.add("form_control_container"),x.appendChild(S);var R=document.createElement("label");R.classList.add("form_control_container_label"),R.innerText="Max",R.setAttribute("for","maxInput"+c),S.appendChild(R);var _,I=document.createElement("input");I.id="maxInput"+c,I.type="number",I.min=1,I.max=getTCodeMax(),I.value=u,S.appendChild(I),x.appendChild(b),x.appendChild(M),x.appendChild(S),(_=document.createElement("div")).classList.add("range_container"),_.appendChild(x),_.appendChild(f),e.appendChild(_),this.fillSlider(E,T,this.rangeColor,this.sliderColor,T),this.setToggleAccessible(T,T),E.oninput=function(e,n,t,a,l){this.controlMinSlider(e,n,t,a,n,l)}.bind(this,E,T,y,I,c),T.oninput=function(e,n,t,a,l){this.controlMaxSlider(e,n,t,a,n,l)}.bind(this,E,T,y,I,c),y.oninput=function(e,n,t,a,l){this.controlMinInput(e,n,t,a,n,l)}.bind(this,E,T,y,I,c),I.oninput=function(e,n,t,a,l){this.controlMaxInput(e,n,t,a,n,l)}.bind(this,E,T,y,I,c)}}this.updateAllToggleChk()},updateSettings(e){updateUserSettings(e,EndPointType.ChannelProfiles.uri,channelsProfileSettings)},updateAllToggleChk(){let e=!1,n=!1;for(var t=0;t<this.channels.length;t++)this.channels[t].rangeLimitEnabled?e=!0:n=!0;let a=document.getElementById("allEnabledCheckbox");n&&e?a.indeterminate=!0:n&&!e?(a.checked=!1,a.indeterminate=!1):!n&&e&&(a.checked=!0,a.indeterminate=!1)},updateChannelRangesTemp(e){document.getElementById("channelRangesEnabled").checked=e},show(){document.getElementById("deviceRangesModal").show()},controlMinInput(e,n,t,a,l,i){const[d,r]=this.getParsed(t,a);var s=d+this.minRange;s>getTCodeMax()&&(s=getTCodeMax()-this.minRange),a.min=s,t.checkValidity()&&a.checkValidity()&&(e.value=t.value,this.setChannelRange(i,parseInt(t.value),r),this.fillSlider(t,a,this.rangeColor,this.sliderColor,l),sendTCodeValue(i,e.value,TCodeModifierType.SPEED,1e3))},controlMaxInput(e,n,t,a,l,i){const[d,r]=this.getParsed(t,a);this.setToggleAccessible(a,n);var s=r-this.minRange;s<getTCodeMin()&&(s=getTCodeMin()+this.minRange),t.max=s,a.checkValidity()&&t.checkValidity()&&(n.value=a.value,this.setChannelRange(i,d,parseInt(a.value)),this.fillSlider(t,a,this.rangeColor,this.sliderColor,l),sendTCodeValue(i,a.value,TCodeModifierType.SPEED,1e3))},controlMinSlider(e,n,t,a,l,i){const[d,r]=this.getParsed(e,n);if(this.fillSlider(e,n,this.rangeColor,this.sliderColor,l),t.value=d,d>=r){var s=d+this.minRange;s>getTCodeMax()&&(s=getTCodeMax(),t.value=s-this.minRange,e.value=s-this.minRange),n.value=s,a.value=s}this.setChannelRange(i,parseInt(t.value),r),sendTCodeValue(i,t.value,TCodeModifierType.SPEED,1e3)},controlMaxSlider(e,n,t,a,l,i){const[d,r]=this.getParsed(e,n);if(this.fillSlider(e,n,this.rangeColor,this.sliderColor,l),this.setToggleAccessible(n,n),a.value=r,r<=d){var s=r-this.minRange;s<getTCodeMin()&&(s=getTCodeMin(),a.value=s+this.minRange,n.value=s+this.minRange),e.value=s,t.value=s}this.setChannelRange(i,d,parseInt(a.value)),sendTCodeValue(i,a.value,TCodeModifierType.SPEED,1e3)},toggleChannelEnabled(e,n){for(var t=0;t<channelsProfileSettings.channelProfile.length;t++){var a=channelsProfileSettings.channelProfile[t];if(a.name==e){a.rangeLimitEnabled=n;break}}},setChannelRange(e,n,t){for(var a=0;a<channelsProfileSettings.channelProfile.length;a++){var l=channelsProfileSettings.channelProfile[a];if(l.name==e){l.userMin=n,l.userMax=t,this.updateSettings();break}}},getParsed:(e,n)=>[parseInt(e.value,10),parseInt(n.value,10)],fillSlider(e,n,t,a,l){const i=n.max-e.min,d=e.value,r=n.value,s=`linear-gradient(\n        to right,\n        ${t} 0%,\n        ${t} ${d/i*100}%,\n        ${a} ${d/i*100}%,\n        ${a} ${r/i*100}%, \n        ${t} ${r/i*100}%, \n        ${t} 100%)`.replace(/[\n\r\t]/gm,"");l.style.background=s},setToggleAccessible(e,n){Number(e.value)<=0?n.style.zIndex=2:n.style.zIndex=0}};