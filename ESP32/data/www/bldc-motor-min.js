function updateBLDCSettings(){userSettings.BLDC_UseHallSensor=document.getElementById("BLDC_UseHallSensor").checked,Utils.toggleControlVisibilityByID("HallEffect",userSettings.BLDC_UseHallSensor),userSettings.BLDC_Pulley_Circumference=parseInt(document.getElementById("BLDC_Pulley_Circumference").value),userSettings.BLDC_MotorA_Voltage=Utils.round2(parseFloat(document.getElementById("BLDC_MotorA_Voltage").value)),userSettings.BLDC_MotorA_Supply=Utils.round2(parseFloat(document.getElementById("BLDC_MotorA_Supply").value)),userSettings.BLDC_MotorA_Current=Utils.round2(parseFloat(document.getElementById("BLDC_MotorA_Current").value)),userSettings.BLDC_MotorA_ZeroElecAngle=Utils.round2(parseFloat(document.getElementById("BLDC_MotorA_ZeroElecAngle").value)),userSettings.BLDC_MotorA_ParametersKnown=document.getElementById("BLDC_MotorA_ParametersKnown").checked,userSettings.BLDC_RailLength=parseInt(document.getElementById("BLDC_RailLength").value),userSettings.BLDC_StrokeLength=parseInt(document.getElementById("BLDC_StrokeLength").value),Utils.toggleControlVisibilityByID("ZeroElecAngle",userSettings.BLDC_MotorA_ParametersKnown),setRestartRequired(),updateUserSettings()}function updateBLDCPins(){null!==upDateTimeout&&clearTimeout(upDateTimeout),upDateTimeout=setTimeout((()=>{var e=validateBLDCPins();e&&(pinoutSettings.BLDC_ChipSelect_PIN=e.BLDC_ChipSelect_PIN,pinoutSettings.BLDC_Encoder_PIN=e.BLDC_Encoder_PIN,pinoutSettings.BLDC_Enable_PIN=e.BLDC_Enable_PIN,pinoutSettings.BLDC_PWMchannel1_PIN=e.BLDC_PWMchannel1_PIN,pinoutSettings.BLDC_PWMchannel2_PIN=e.BLDC_PWMchannel2_PIN,pinoutSettings.BLDC_PWMchannel3_PIN=e.BLDC_PWMchannel3_PIN,pinoutSettings.BLDC_HallEffect_PIN=e.BLDC_HallEffect_PIN,updateCommonPins(e),setRestartRequired(),postPinoutSettings())}),2e3)}function getBLDCPinValues(){var e={};return e.BLDC_ChipSelect_PIN=parseInt(document.getElementById("BLDC_ChipSelect_PIN").value),e.BLDC_Encoder_PIN=parseInt(document.getElementById("BLDC_Encoder_PIN").value),e.BLDC_Enable_PIN=parseInt(document.getElementById("BLDC_Enable_PIN").value),e.BLDC_PWMchannel1_PIN=parseInt(document.getElementById("BLDC_PWMchannel1_PIN").value),e.BLDC_PWMchannel2_PIN=parseInt(document.getElementById("BLDC_PWMchannel2_PIN").value),e.BLDC_PWMchannel3_PIN=parseInt(document.getElementById("BLDC_PWMchannel3_PIN").value),e.BLDC_HallEffect_PIN=parseInt(document.getElementById("BLDC_HallEffect_PIN").value),getCommonPinValues(e),e}function validateBLDCPins(){clearErrors("pinValidation");var e=[],t=[],n=[],l=getBLDCPinValues();if(userSettings.disablePinValidation)return l;isModuleType(ModuleType.S3)&&isBoardType(BoardType.ZERO)?isBLDCSPI()&&e.push({name:"SPI MOSI",pin:11}):(e.push({name:"SPI CLK",pin:18}),e.push({name:"SPI MISO",pin:19}),isBLDCSPI()&&e.push({name:"SPI MOSI",pin:23})),validatePin(l.BLDC_Encoder_PIN,"Encoder",e,t),validatePin(l.BLDC_ChipSelect_PIN,"Chip select",e,t),validatePin(l.BLDC_Enable_PIN,"Enable",e,t),validatePWMPin(l.rightPin,"PWMchannel1",e,t,n),validatePWMPin(l.rightPin,"PWMchannel2",e,t,n),validatePWMPin(l.BLDC_PWMchannel3_PIN,"PWMchannel3",e,t,n),userSettings.BLDC_UseHallSensor&&validatePin(l.BLDC_HallEffect_PIN,"HallEffect",e,t),validateCommonPWMPins(e,t,l,n);var i=[];if(validateNonPWMPins(e,t,i,l),t.length||n.length||i.length){var o="<div name='pinValidation'>Pins NOT saved due to invalid input.<br>";return t.length&&(o+="<div style='margin-left: 25px;'>The following pins are duplicated:<br><div style='color: white; margin-left: 25px;'>"+t.join("<br>")+"</div></div>"),i.length&&(t.length&&(o+="<br>"),o+="<div style='margin-left: 25px;'>The following pins are invalid:<br><div style='color: white; margin-left: 25px;'>"+i.join("<br>")+"</div></div>"),n.length&&((t.length||i.length)&&(o+="<br>"),o+="<div style='margin-left: 25px;'>The following pins are invalid PWM pins:<br><div style='color: white; margin-left: 25px;'>"+n.join("<br>")+"</div></div>"),o+="</div>",void showError(o)}return l}BLDCMotor={setup(){document.getElementById("BLDC_Encoder").value=userSettings.BLDC_Encoder,document.getElementById("BLDC_UseHallSensor").checked=userSettings.BLDC_UseHallSensor,document.getElementById("BLDC_Pulley_Circumference").value=userSettings.BLDC_Pulley_Circumference,document.getElementById("BLDC_MotorA_Voltage").value=Utils.round2(userSettings.BLDC_MotorA_Voltage),document.getElementById("BLDC_MotorA_Supply").value=Utils.round2(userSettings.BLDC_MotorA_Supply),document.getElementById("BLDC_MotorA_Current").value=Utils.round2(userSettings.BLDC_MotorA_Current),document.getElementById("BLDC_ChipSelect_PIN").value=pinoutSettings.BLDC_ChipSelect_PIN,document.getElementById("BLDC_Encoder_PIN").value=pinoutSettings.BLDC_Encoder_PIN,document.getElementById("BLDC_Enable_PIN").value=pinoutSettings.BLDC_Enable_PIN,document.getElementById("BLDC_PWMchannel1_PIN").value=pinoutSettings.BLDC_PWMchannel1_PIN,document.getElementById("BLDC_PWMchannel2_PIN").value=pinoutSettings.BLDC_PWMchannel2_PIN,document.getElementById("BLDC_PWMchannel3_PIN").value=pinoutSettings.BLDC_PWMchannel3_PIN,document.getElementById("BLDC_HallEffect_PIN").value=pinoutSettings.BLDC_HallEffect_PIN,document.getElementById("BLDC_MotorA_ZeroElecAngle").value=Utils.round2(userSettings.BLDC_MotorA_ZeroElecAngle),document.getElementById("BLDC_MotorA_ParametersKnown").checked=userSettings.BLDC_MotorA_ParametersKnown,document.getElementById("BLDC_RailLength").value=userSettings.BLDC_RailLength,document.getElementById("BLDC_StrokeLength").value=userSettings.BLDC_StrokeLength,toggleBLDCEncoderOptions(),Utils.toggleControlVisibilityByID("HallEffect",userSettings.BLDC_UseHallSensor),Utils.toggleControlVisibilityByID("ZeroElecAngle",userSettings.BLDC_MotorA_ParametersKnown)}};